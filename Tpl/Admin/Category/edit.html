<?php
defined('IN_ADMIN') or exit('No permission resources.');
?>
<extend name="Public:form_layout" />
<block name="title"><title>添加推荐位</title></block>
<block name="subnav">
  <a class="add fb" href="__URL__/add"><em>添加商铺可经营类别</em></a>　    <a href="__URL__/index"><em>商铺可经营类别</em></a>
</block>
<block name="main">
  <div class="common-form">
    <form name="myform" action="__URL__/edit" method="post" id="myform">
      <input type="hidden" name="id" value="<?php echo $category['id']; ?>">
      <table width="100%" class="table_form contentWrap">
        <tr>
          <th width="100"><font class="red">*</font>名称</th>
          <td>
            <input type="text" name="info[name]" value="<?php echo $category['name']; ?>" class="input-text" id="name">
          </td>
        </tr>
        <tr>
          <th width="100"><font class="red">*</font>所属分类</th>
          <td>
            <select name="info[belong]" id="typeid">
              <option value="0" <?php echo $category['belong'] == 0 ? 'selected' : ''; ?>>公用</option>
              <?php foreach ($types as $key => $value) { ?>
              <option value='<?php echo $key; ?>' <?php echo $category['belong'] == $key ? 'selected' : ''; ?>><?php echo $value; ?></option>
              <?php } ?>
            </select>
          </td>
        </tr>
        <tr>
          <th width="100">排序</th>
          <td><input type="text" name="info[sort]" class="input-text" size="5" value="<?php echo $category['sort']; ?>"></input></td>
        </tr>
      </table>
      <div class="bk15"></div>
      <input name="dosubmit" type="submit" class="button" value="提交">
    </form>
  </div>
  <script type="text/javascript">
    var categorys = '<?php echo json_encode($categorys); ?>';
    $(function() {
      $.formValidator.initConfig({autotip:true,formid:"myform",onerror:function(msg){}});
      $("#name").formValidator({onshow:"请输入名字",onfocus:"名称不能为空"}).inputValidator({min:1,max:50,onerror:"名称不能为空"}).defaultPassed();
      $("#typeid").formValidator({onshow:"请选择分类",onfocus:"请选择分类"}).inputValidator({min:0,onerror:"分类必选"}).defaultPassed();
      $("#pid").formValidator({onshow:"请选择父区域",onfocus:"请选择父区域"}).inputValidator({min:0,onerror:"父区域必选"}).defaultPassed();

      $('#typeid').change(function(){
        belong = $(this).val();
        pid_options = '<option value="0">顶级区域</option>';
        $.each($.parseJSON(categorys), function( index, obj ){
          if ( obj.belong == belong || obj.belong == 0 )
          pid_options += '<option value="' + obj.id + '">' + obj.name + '</option>';
        });
        $('#pid').html( pid_options );
      });

    })
  </script>
</block>